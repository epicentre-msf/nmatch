<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='Compare proper names across two sources using string-standardization to
account for variation in punctuation, accents, and character case,
token-permutation to account for variation in name order, and fuzzy matching
to handle alternate spellings. The specific steps are:
Standardize strings. The default function is
name_standardize which removes accents and punctuation,
standardizes case, and removes extra whitespace. E.g. "Brontë, Emily J." is
standardized to "BRONTE EMILY J".
Tokenize standardized names, optionally retaining only tokens larger than
a given nchar limit.
For each pair of names, calculate string distance between all combinations
of tokens, and find the best overall token alignment (i.e. the alignment that
minimizes the summed string distance). If two names being compared differ in
their number of tokens, the alignment is made with respect to the smaller
number of tokens. E.g. If comparing "Angela Dorothea Merkel" to "Merkel
Angela", the token "Dorothea" would ultimately be omitted from the best
alignment.
Summarize the number of tokens in each name, the number of tokens in the
best alignment, the number of aligned tokens that match (i.e. string
distance less than or equal to the defined threshold), and the summed string
distance of the best alignment.
Classify overall match status (TRUE/FALSE) based on match details
described in (4). By default, two names are considered to be matching if two
or more tokens match across names (e.g. "Merkel Angela" matches "Angela
Dorothea Merkel"), or if both names consist of only a single token which is
matching (e.g. "Beyonce" matches "Beyoncé").

'><title>Compare sets of proper names accounting for common types of variation in
format and style — nmatch • nmatch</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compare sets of proper names accounting for common types of variation in
format and style — nmatch"><meta property="og:description" content='Compare proper names across two sources using string-standardization to
account for variation in punctuation, accents, and character case,
token-permutation to account for variation in name order, and fuzzy matching
to handle alternate spellings. The specific steps are:
Standardize strings. The default function is
name_standardize which removes accents and punctuation,
standardizes case, and removes extra whitespace. E.g. "Brontë, Emily J." is
standardized to "BRONTE EMILY J".
Tokenize standardized names, optionally retaining only tokens larger than
a given nchar limit.
For each pair of names, calculate string distance between all combinations
of tokens, and find the best overall token alignment (i.e. the alignment that
minimizes the summed string distance). If two names being compared differ in
their number of tokens, the alignment is made with respect to the smaller
number of tokens. E.g. If comparing "Angela Dorothea Merkel" to "Merkel
Angela", the token "Dorothea" would ultimately be omitted from the best
alignment.
Summarize the number of tokens in each name, the number of tokens in the
best alignment, the number of aligned tokens that match (i.e. string
distance less than or equal to the defined threshold), and the summed string
distance of the best alignment.
Classify overall match status (TRUE/FALSE) based on match details
described in (4). By default, two names are considered to be matching if two
or more tokens match across names (e.g. "Merkel Angela" matches "Angela
Dorothea Merkel"), or if both names consist of only a single token which is
matching (e.g. "Beyonce" matches "Beyoncé").

'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">nmatch</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/epicentre-msf/nmatch/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Compare sets of proper names accounting for common types of variation in
format and style</h1>
      <small class="dont-index">Source: <a href="https://github.com/epicentre-msf/nmatch/blob/HEAD/R/nmatch.R" class="external-link"><code>R/nmatch.R</code></a></small>
      <div class="d-none name"><code>nmatch.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compare proper names across two sources using string-standardization to
account for variation in punctuation, accents, and character case,
token-permutation to account for variation in name order, and fuzzy matching
to handle alternate spellings. The specific steps are:</p><ol><li><p>Standardize strings. The default function is
<code><a href="name_standardize.html">name_standardize</a></code> which removes accents and punctuation,
standardizes case, and removes extra whitespace. E.g. "Brontë, Emily J." is
standardized to "BRONTE EMILY J".</p></li>
<li><p>Tokenize standardized names, optionally retaining only tokens larger than
a given nchar limit.</p></li>
<li><p>For each pair of names, calculate string distance between all combinations
of tokens, and find the best overall token alignment (i.e. the alignment that
minimizes the summed string distance). If two names being compared differ in
their number of tokens, the alignment is made with respect to the smaller
number of tokens. E.g. If comparing "Angela Dorothea Merkel" to "Merkel
Angela", the token "Dorothea" would ultimately be omitted from the best
alignment.</p></li>
<li><p>Summarize the number of tokens in each name, the number of tokens in the
best alignment, the number of aligned tokens that match (i.e. string
distance less than or equal to the defined threshold), and the summed string
distance of the best alignment.</p></li>
<li><p>Classify overall match status (TRUE/FALSE) based on match details
described in (4). By default, two names are considered to be matching if two
or more tokens match across names (e.g. "Merkel Angela" matches "Angela
Dorothea Merkel"), or if both names consist of only a single token which is
matching (e.g. "Beyonce" matches "Beyoncé").</p></li>
</ol></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">nmatch</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  token_split <span class="op">=</span> <span class="st">"[-_[:space:]]+"</span>,</span>
<span>  nchar_min <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>  dist_method <span class="op">=</span> <span class="st">"osa"</span>,</span>
<span>  dist_max <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  std <span class="op">=</span> <span class="va">name_standardize</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  return_full <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  eval_fn <span class="op">=</span> <span class="va">match_eval</span>,</span>
<span>  eval_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n_match_crit <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x, y</dt>
<dd><p>Vectors of proper names to compare. Must be of same length.</p></dd>


<dt>token_split</dt>
<dd><p>Regex pattern to split strings into tokens. Defaults to
<code>"[-_[:space:]]+"</code>, which splits at each sequence of one more dash,
underscore, or space character.</p></dd>


<dt>nchar_min</dt>
<dd><p>Minimum token size to compare. Defaults to <code>2L</code>.</p></dd>


<dt>dist_method</dt>
<dd><p>Method to use for string distance calculation (see
<a href="https://rdrr.io/pkg/stringdist/man/stringdist-metrics.html" class="external-link">stringdist-metrics</a>). Defaults to <code>"osa"</code>.</p></dd>


<dt>dist_max</dt>
<dd><p>Maximum string distance to use to classify matching tokens
(i.e. tokens with a string distance less than or equal to <code>dist_max</code> will
be considered matching). Defaults to <code>1L</code>.</p></dd>


<dt>std</dt>
<dd><p>Function to standardize strings during matching. Defaults to
<code><a href="name_standardize.html">name_standardize</a></code>. Set to <code>NULL</code> to omit standardization.</p></dd>


<dt>...</dt>
<dd><p>additional arguments passed to <code>std()</code></p></dd>


<dt>return_full</dt>
<dd><p>Logical indicating whether to return data frame with full
summary of match details (<code>TRUE</code>), or only a logical vector corresponding
to final match status (<code>FALSE</code>). Defaults to <code>FALSE</code>.</p></dd>


<dt>eval_fn</dt>
<dd><p>Function to determine overall match status. Defaults to
<code><a href="match_eval.html">match_eval</a></code>. See section <em>Custom classification functions</em> for
more details.</p></dd>


<dt>eval_params</dt>
<dd><p>List of additional arguments passed to <code>eval_fn</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>If <code>return_full = FALSE</code> (the default), returns a logical vector indicating
which elements of <code>x</code> and <code>y</code> are matches.</p>


<p>If <code>return_full = TRUE</code>, returns a tibble-style data frame summarizing the
match details, including columns:</p><ul><li><p><code>is_match</code>: logical vector indicating overall match status</p></li>
<li><p><code>k_x</code>: number of tokens in <code>x</code> (excludes tokens smaller than <code>nchar_min</code>)</p></li>
<li><p><code>k_y</code>: number of tokens in <code>y</code> (excludes tokens smaller than <code>nchar_min</code>)</p></li>
<li><p><code>k_align</code>: number of aligned tokens (i.e. <code>min(k_x, k_y)</code>)</p></li>
<li><p><code>n_match</code>: number of aligned tokens that match (i.e. distance &lt;= <code>dist_max</code>)</p></li>
<li><p><code>dist_total</code>: summed string distance across aligned tokens</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">names1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"Angela Dorothea Merkel"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"Emmanuel Jean-Michel Fr\u00e9d\u00e9ric Macron"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"Mette Frederiksen"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"Katrin Jakobsd\u00f3ttir"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"Pedro S\u00e1nchez P\u00e9rez-Castej\u00f3n"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">names2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"MERKEL, Angela"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"MACRON, Emmanuel J.-M. F."</span>,</span></span>
<span class="r-in"><span>  <span class="st">"FREDERICKSON, Mette"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"JAKOBSDOTTIR  Kathríne"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"PEREZ-CASTLEJON, Pedro"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># return logical vector specifying which names are matches</span></span></span>
<span class="r-in"><span><span class="fu">nmatch</span><span class="op">(</span><span class="va">names1</span>, <span class="va">names2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  TRUE  TRUE FALSE FALSE  TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># increase the threshold string distance to allow for 'fuzzier' matches</span></span></span>
<span class="r-in"><span><span class="fu">nmatch</span><span class="op">(</span><span class="va">names1</span>, <span class="va">names2</span>, dist_max <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE TRUE TRUE TRUE TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># return data frame with full match details</span></span></span>
<span class="r-in"><span><span class="fu">nmatch</span><span class="op">(</span><span class="va">names1</span>, <span class="va">names2</span>, return_full <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 5 × 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   is_match   k_x   k_y k_align n_match dist_total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> TRUE         3     2       2       2          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> TRUE         5     2       2       2          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> FALSE        2     2       2       1          2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> FALSE        2     2       2       1          2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> TRUE         4     3       3       3          1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use a custom function to classify matches</span></span></span>
<span class="r-in"><span><span class="va">classify_matches</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">k_align</span>, <span class="va">n_match</span>, <span class="va">dist_total</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">n_match</span> <span class="op">==</span> <span class="va">k_align</span> <span class="op">&amp;</span> <span class="va">dist_total</span> <span class="op">&lt;</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">nmatch</span><span class="op">(</span><span class="va">names1</span>, <span class="va">names2</span>, return_full <span class="op">=</span> <span class="cn">TRUE</span>, eval_fn <span class="op">=</span> <span class="va">classify_matches</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 5 × 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   is_match   k_x   k_y k_align n_match dist_total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> TRUE         3     2       2       2          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> TRUE         5     2       2       2          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> FALSE        2     2       2       1          2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> FALSE        2     2       2       1          2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> TRUE         4     3       3       3          1</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Patrick Barks.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

